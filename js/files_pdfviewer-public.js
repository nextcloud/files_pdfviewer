(()=>{var e={9097:(e,t,r)=>{"use strict";t.c0=function(e){return new s.default(e)};var s=n(r(9457)),i=n(r(432));function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){Object.keys(e).filter((e=>!t||t(e))).map(e.removeItem.bind(e))}},432:(e,t)=>{"use strict";function r(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:s+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class s{constructor(e,t,i){r(this,"scope",void 0),r(this,"wrapped",void 0),this.scope="".concat(i?s.GLOBAL_SCOPE_PERSISTENT:s.GLOBAL_SCOPE_VOLATILE,"_").concat(btoa(e),"_"),this.wrapped=t}scopeKey(e){return"".concat(this.scope).concat(e)}setItem(e,t){this.wrapped.setItem(this.scopeKey(e),t)}getItem(e){return this.wrapped.getItem(this.scopeKey(e))}removeItem(e){this.wrapped.removeItem(this.scopeKey(e))}clear(){Object.keys(this.wrapped).filter((e=>e.startsWith(this.scope))).map(this.wrapped.removeItem.bind(this.wrapped))}}t.default=s,r(s,"GLOBAL_SCOPE_VOLATILE","nextcloud_vol"),r(s,"GLOBAL_SCOPE_PERSISTENT","nextcloud_per")},9457:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,i=(s=r(432))&&s.__esModule?s:{default:s};function n(e,t,r){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:s+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.default=class{constructor(e){n(this,"appId",void 0),n(this,"persisted",!1),n(this,"clearedOnLogout",!1),this.appId=e}persist(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.persisted=e,this}clearOnLogout(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.clearedOnLogout=e,this}build(){return new i.default(this.appId,this.persisted?window.localStorage:window.sessionStorage,!this.clearedOnLogout)}}},5950:(e,t,r)=>{const s=r(2322),{MAX_LENGTH:i,MAX_SAFE_INTEGER:n}=r(6692),{safeRe:o,t:a}=r(5208),l=r(9901),{compareIdentifiers:c}=r(3229);class E{constructor(e,t){if(t=l(t),e instanceof E){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?o[a.LOOSE]:o[a.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof E)){if("string"==typeof e&&e===this.version)return 0;e=new E(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof E||(e=new E(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof E||(e=new E(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],i=e.prerelease[t];if(s("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return c(r,i)}while(++t)}compareBuild(e){e instanceof E||(e=new E(e,this.options));let t=0;do{const r=this.build[t],i=e.build[t];if(s("build compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return c(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let s=this.prerelease.length;for(;--s>=0;)"number"==typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);if(-1===s){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let s=[t,e];!1===r&&(s=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=E},5683:(e,t,r)=>{const s=r(5950);e.exports=(e,t)=>new s(e,t).major},8690:(e,t,r)=>{const s=r(5950);e.exports=(e,t,r=!1)=>{if(e instanceof s)return e;try{return new s(e,t)}catch(e){if(!r)return null;throw e}}},8711:(e,t,r)=>{const s=r(8690);e.exports=(e,t)=>{const r=s(e,t);return r?r.version:null}},6692:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},2322:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},3229:e=>{const t=/^[0-9]+$/,r=(e,r)=>{const s=t.test(e),i=t.test(r);return s&&i&&(e=+e,r=+r),e===r?0:s&&!i?-1:i&&!s?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},9901:e=>{const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},5208:(e,t,r)=>{const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:n}=r(6692),o=r(2322),a=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],E=t.t={};let h=0;const u="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",n],[u,i]],d=(e,t,r)=>{const s=(e=>{for(const[t,r]of p)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),i=h++;o(e,i,t),E[e]=i,c[i]=t,a[i]=new RegExp(t,r?"g":void 0),l[i]=new RegExp(s,r?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${u}*`),d("MAINVERSION",`(${c[E.NUMERICIDENTIFIER]})\\.(${c[E.NUMERICIDENTIFIER]})\\.(${c[E.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${c[E.NUMERICIDENTIFIERLOOSE]})\\.(${c[E.NUMERICIDENTIFIERLOOSE]})\\.(${c[E.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${c[E.NUMERICIDENTIFIER]}|${c[E.NONNUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${c[E.NUMERICIDENTIFIERLOOSE]}|${c[E.NONNUMERICIDENTIFIER]})`),d("PRERELEASE",`(?:-(${c[E.PRERELEASEIDENTIFIER]}(?:\\.${c[E.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${c[E.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[E.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${u}+`),d("BUILD",`(?:\\+(${c[E.BUILDIDENTIFIER]}(?:\\.${c[E.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${c[E.MAINVERSION]}${c[E.PRERELEASE]}?${c[E.BUILD]}?`),d("FULL",`^${c[E.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${c[E.MAINVERSIONLOOSE]}${c[E.PRERELEASELOOSE]}?${c[E.BUILD]}?`),d("LOOSE",`^${c[E.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${c[E.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${c[E.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${c[E.XRANGEIDENTIFIER]})(?:\\.(${c[E.XRANGEIDENTIFIER]})(?:\\.(${c[E.XRANGEIDENTIFIER]})(?:${c[E.PRERELEASE]})?${c[E.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${c[E.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[E.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[E.XRANGEIDENTIFIERLOOSE]})(?:${c[E.PRERELEASELOOSE]})?${c[E.BUILD]}?)?)?`),d("XRANGE",`^${c[E.GTLT]}\\s*${c[E.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${c[E.GTLT]}\\s*${c[E.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),d("COERCE",`${c[E.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",c[E.COERCEPLAIN]+`(?:${c[E.PRERELEASE]})?`+`(?:${c[E.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",c[E.COERCE],!0),d("COERCERTLFULL",c[E.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${c[E.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",d("TILDE",`^${c[E.LONETILDE]}${c[E.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${c[E.LONETILDE]}${c[E.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${c[E.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",d("CARET",`^${c[E.LONECARET]}${c[E.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${c[E.LONECARET]}${c[E.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${c[E.GTLT]}\\s*(${c[E.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${c[E.GTLT]}\\s*(${c[E.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${c[E.GTLT]}\\s*(${c[E.LOOSEPLAIN]}|${c[E.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${c[E.XRANGEPLAIN]})\\s+-\\s+(${c[E.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${c[E.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[E.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}(()=>{"use strict";const e=(e,t,r)=>{const s=Object.assign({escape:!0},r||{});return"/"!==e.charAt(0)&&(e="/"+e),i=(i=t||{})||{},e.replace(/{([^{}]*)}/g,(function(e,t){const r=i[t];return s.escape?encodeURIComponent("string"==typeof r||"number"==typeof r?r.toString():e):"string"==typeof r||"number"==typeof r?r.toString():e}));var i},t=(t,r,i)=>{var n,o,a;const l=Object.assign({noRewrite:!1},i||{}),c=null!=(n=null==i?void 0:i.baseURL)?n:s();return!0!==(null==(a=null==(o=null==window?void 0:window.OC)?void 0:o.config)?void 0:a.modRewriteWorking)||l.noRewrite?c+"/index.php"+e(t,r,i):c+e(t,r,i)};function s(){let e=window._oc_webroot;if(typeof e>"u"){e=location.pathname;const t=e.indexOf("/index.php/");if(-1!==t)e=e.slice(0,t);else{const t=e.indexOf("/",1);e=e.slice(0,t>0?t:void 0)}}return e}var i=r(8711),n=r(5683);class o{bus;constructor(e){"function"==typeof e.getVersion&&i(e.getVersion())?n(e.getVersion())!==n(this.getVersion())&&console.warn("Proxying an event bus of version "+e.getVersion()+" with "+this.getVersion()):console.warn("Proxying an event bus with an unknown or invalid version"),this.bus=e}getVersion(){return"3.3.1"}subscribe(e,t){this.bus.subscribe(e,t)}unsubscribe(e,t){this.bus.unsubscribe(e,t)}emit(e,t){this.bus.emit(e,t)}}class a{handlers=new Map;getVersion(){return"3.3.1"}subscribe(e,t){this.handlers.set(e,(this.handlers.get(e)||[]).concat(t))}unsubscribe(e,t){this.handlers.set(e,(this.handlers.get(e)||[]).filter((e=>e!==t)))}emit(e,t){(this.handlers.get(e)||[]).forEach((e=>{try{e(t)}catch(e){console.error("could not invoke event listener",e)}}))}}let l=null;function c(){return null!==l?l:"undefined"==typeof window?new Proxy({},{get:()=>()=>console.error("Window not available, EventBus can not be established!")}):(window.OC?._eventBus&&void 0===window._nc_event_bus&&(console.warn("found old event bus instance at OC._eventBus. Update your version!"),window._nc_event_bus=window.OC._eventBus),l=void 0!==window?._nc_event_bus?new o(window._nc_event_bus):window._nc_event_bus=new a,l)}var E=r(9097);let h;const u=[];var p,d;p="csrf-token-update",d=e=>{h=e.token,u.forEach((e=>{try{e(h)}catch(e){console.error("Error updating CSRF token observer",e)}}))},c().subscribe(p,d);(0,E.c0)("public").persist().build();let I;const f=(e,t)=>e?e.getAttribute(t):null;var L=(e=>(e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Fatal=4]="Fatal",e))(L||{}),R=Object.defineProperty,m=(e,t,r)=>(((e,t,r)=>{t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class O{constructor(e){m(this,"context"),this.context=e||{}}formatMessage(e,t,r){let s="["+L[t].toUpperCase()+"] ";return r&&r.app&&(s+=r.app+": "),"string"==typeof e?s+e:(s+="Unexpected ".concat(e.name),e.message&&(s+=' "'.concat(e.message,'"')),t===L.Debug&&e.stack&&(s+="\n\nStack trace:\n".concat(e.stack)),s)}log(e,t,r){var s,i;if(!("number"==typeof(null==(s=this.context)?void 0:s.level)&&e<(null==(i=this.context)?void 0:i.level)))switch("object"==typeof t&&void 0===(null==r?void 0:r.error)&&(r.error=t),e){case L.Debug:console.debug(this.formatMessage(t,L.Debug,r),r);break;case L.Info:console.info(this.formatMessage(t,L.Info,r),r);break;case L.Warn:console.warn(this.formatMessage(t,L.Warn,r),r);break;case L.Error:console.error(this.formatMessage(t,L.Error,r),r);break;case L.Fatal:default:console.error(this.formatMessage(t,L.Fatal,r),r)}}debug(e,t){this.log(L.Debug,e,Object.assign({},this.context,t))}info(e,t){this.log(L.Info,e,Object.assign({},this.context,t))}warn(e,t){this.log(L.Warn,e,Object.assign({},this.context,t))}error(e,t){this.log(L.Error,e,Object.assign({},this.context,t))}fatal(e,t){this.log(L.Fatal,e,Object.assign({},this.context,t))}}function v(e){return new O(e)}var N=Object.defineProperty,b=(e,t,r)=>(((e,t,r)=>{t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class g{constructor(e){b(this,"context"),b(this,"factory"),this.context={},this.factory=e}setApp(e){return this.context.app=e,this}setLogLevel(e){return this.context.level=e,this}setUid(e){return this.context.uid=e,this}detectUser(){const e=function(){if(void 0!==I)return I;const e=document?.getElementsByTagName("head")[0];if(!e)return null;const t=f(e,"data-user");return null===t?(I=null,I):(I={uid:t,displayName:f(e,"data-user-displayname"),isAdmin:!!window._oc_isadmin},I)}();return null!==e&&(this.context.uid=e.uid),this}detectLogLevel(){const e=this,t=()=>{var r,s;"complete"===document.readyState||"interactive"===document.readyState?(e.context.level=null!=(s=null==(r=window._oc_config)?void 0:r.loglevel)?s:L.Warn,window._oc_debug&&(e.context.level=L.Debug),document.removeEventListener("readystatechange",t)):document.addEventListener("readystatechange",t)};return t(),this}build(){return void 0===this.context.level&&this.detectLogLevel(),this.factory(this.context)}}function w(){return new g(v)}const A=w().setApp("Files_PDFViewer").detectUser().build(),$=document.getElementById("hideDownload"),T=()=>!$||$&&"true"!==$.value,S=document.getElementById("isPublic"),y=()=>!(!S||"1"!==S.value),P=document.getElementById("mimetype"),_=()=>P&&"application/pdf"===P.value,D=()=>!T()&&void 0!==OCA.RichDocuments;window.addEventListener("DOMContentLoaded",(function(){if(A.debug("Initializing for public page",{isPublicPage:y(),canDownload:T(),isSecureViewerAvailable:D()}),!y()||_())if(y()&&_()&&!D()){const e=location.hash.split("page=")[1]||0,r=document.getElementById("files-public-content"),s=document.getElementById("sharingToken"),i=document.querySelector("body > footer")||document.querySelector("#app-content > footer"),n=document.querySelector("#content"),o=s.value,a=t("/s/{token}/download",{token:o}),l=t("/apps/files_pdfviewer/?file={downloadUrl}&canDownload={canDownload}#page={page}",{canDownload:T()?1:0,downloadUrl:a,page:e});if(r){if(r.innerHTML="",OCA.Viewer)OCA.Viewer.setRootElement("#files-public-content"),OCA.Viewer.open({path:"/"});else{A.error("Viewer not available, PDF viewer directly injected");const e=document.createElement("iframe");e.style.height="100%",e.style.width="100%",e.style.position="absolute",r.appendChild(e),e.src=l}i.style.display="none",n.style.minHeight="calc(100% - var(--header-height))",n.style.marginLeft="0",n.style.marginRight="0",n.style.width="100%",n.style.borderRadius="unset"}else A.error("Unable to inject the PDF Viewer")}else A.error("But this does not appear to be a public page");else A.debug("But this is not a single pdf share")}))})()})();
//# sourceMappingURL=files_pdfviewer-public.js.map?v=ade7a7c2dde8f60376a3